@import controllers.licencefinder.ResultsController
@import util._
@import views.html.common.page._
@import views.html.common.state._
@import views.html.common.form._
@import models.view.licencefinder.ResultsView

@this(standardPage: standardPage)
@(form: Form[_], resultsView: ResultsView, sessionId: String)

  @title = @{
    Html("")
  }

  @chosenOgelFormField = @{"chosenOgel"}

@standardPage(resultsView.getTitle(), Some(heading(resultsView.getTitle()))){
  @errorSummary(form)
}{

  <form action="@controllers.licencefinder.routes.ResultsController.handleResultsSubmit(sessionId)" method="POST">

    @if(resultsView.hasOgels()) {
      <p>
        Open licences allow you to export certain goods without making a new application each time you export them.
      </p>

      <p>
        Select the option which best matches your requirements.
      </p>


      <fieldset>

          @formRadioGroupContainer(form(chosenOgelFormField))(title, "h4", "heading-small") {
            @for(ogelView <- resultsView.getOgelViews()) {

              <div class="form-group">
                @if(ogelView.getAlreadyRegistered) {
                  <span class="bold" style="margin-left:40px">You have already registered for this OGEL:</span>
                }
              @formRadio(form("chosenOgel"), "<span class=\"bold\">OGEL (" + ogelView.getName + ")</span>", ogelView.getId, true, "label-trade-type")
              @detailPanel("detailPanel"){More information} {
                <p>
                  @ogelView.getUsageSummary().iterator().next()
                </p>
              }
              </div>
            }
<hr>
            @formRadio(form("chosenOgel"), "<span class=\"bold\">None of the above applies fully to my situation</span>", ResultsController.NONE_ABOVE_KEY, true, "label-trade-type")
        }

      </fieldset>

      <button type="submit" class="button">Continue</button>

    } else {
      <p>
        Your goods cannot be exported via an open licence. We will need to know more about the goods you want to export.
      </p>
      <p>
        Please <a href="http://www.spire.trade.gov.uk/" rel="external" target="_blank">log in to Spire<span class="visually-hidden"> (opens in a new tab)</span></a>  to continue..
      </p>
    }

  </form>
}